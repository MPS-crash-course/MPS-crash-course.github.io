
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4. Canonical Form &#8212; MPS Crash Course</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/week2/canonical';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="5. Entanglement and Truncation" href="entanglement.html" />
    <link rel="prev" title="3. Matrix Product States" href="../week1/mps.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../home.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.jpg" class="logo__image only-light" alt="MPS Crash Course - Home"/>
    <img src="../../_static/logo.jpg" class="logo__image only-dark pst-js-only" alt="MPS Crash Course - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../home.html">
                    MPS Crash Course
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week1/intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week1/problem.html">2. The Heisenberg Antiferromagnet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week1/mps.html">3. Matrix Product States</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 2</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">4. Canonical Form</a></li>
<li class="toctree-l1"><a class="reference internal" href="entanglement.html">5. Entanglement and Truncation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tebd.html">6. Time Evolving Block Decimation (TEBD)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week3/mpo.html">7. Matrix Product Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week3/dmrg.html">8. Density Matrix Renormalization Group (DMRG)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 4</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../week4/dsf.html">9. Bringing It All Together</a></li>
<li class="toctree-l1"><a class="reference internal" href="../week4/beyond.html">10. Beyond This Course</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/MPS-crash-course/MPS-crash-course.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/MPS-crash-course/MPS-crash-course.github.io/issues/new?title=Issue%20on%20page%20%2Fcontent/week2/canonical.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/content/week2/canonical.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Canonical Form</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-expectation-values">4.1. Computing expectation values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#moving-the-centre">4.2. Moving the centre</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="canonical-form">
<h1><span class="section-number">4. </span>Canonical Form<a class="headerlink" href="#canonical-form" title="Link to this heading">#</a></h1>
<p>Last week, we showed that matrix product state allows us to represent quantum many-body states in terms of a product of matrices (or as a chain of tensors). This representation is not unique, and we are free to change the individual tensors in the MPS without changing the state it represents. This freedom is known as gauge freedom. For instance, on each virtual bond, we can apply the identity <span class="math notranslate nohighlight">\(1 = X^{-1} X\)</span>, where <span class="math notranslate nohighlight">\(X\)</span> is an invertible matrix. By contracting <span class="math notranslate nohighlight">\(X^{-1}\)</span> and <span class="math notranslate nohighlight">\(X\)</span> with the tensors on the left and right of the bond, we can change the tensors without changing the state, as shown in <a class="reference internal" href="#fig-gauge"><span class="std std-numref">Fig. 4.1</span></a>. We have this freedom on each virtual bond of the MPS</p>
<figure class="align-center" id="fig-gauge">
<a class="reference internal image-reference" href="../../_images/gauge.jpeg"><img alt="../../_images/gauge.jpeg" src="../../_images/gauge.jpeg" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.1 </span><span class="caption-text">Gauge freedom in defining the tensors of an MPS. By introducing an invertible matrix (and its inverse) on the virtual bonds of the MPS, we can change the tensors without changing the state.</span><a class="headerlink" href="#fig-gauge" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Given this freedom in the MPS representation, there are particular forms for the tensors that have special useful properties that simplify calculations. These are called <em>canonical forms</em>. The most commonly used canonical forms are the left and right canonical forms. We will label tensors <span class="math notranslate nohighlight">\(A^{[n]}\)</span> if they are in left canonical form, and <span class="math notranslate nohighlight">\(B^{[n]}\)</span> if they are in right canonical form. Left canonical form is defined by the conditions shown in tensor network notation in <a class="reference internal" href="#fig-canonical"><span class="std std-numref">Fig. 4.2</span></a>. That is, contracting left canonical form tensors from the left results in the identity. Additionally, the diagonal matrix of Schmidt values is the unique right eigenvector of the left-canonical transfer matrix. This second condition is not one that we will make use of in this course, but it is a useful property of the left canonical form. The right canonical form is defined similarly, but with the conditions reversed.</p>
<figure class="align-center" id="fig-canonical">
<a class="reference internal image-reference" href="../../_images/canonical.jpeg"><img alt="../../_images/canonical.jpeg" src="../../_images/canonical.jpeg" style="width: 75%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.2 </span><span class="caption-text">Left and right canonical forms. Contracting the left virtual and physical indices of left canonical tensors with their conjugate results in the identity. The square of the Schmidt values are the right eigenvector of the left canonical form transfer matrix. Similarly for right canonical, but with in other direction.</span><a class="headerlink" href="#fig-canonical" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>A state can be written purely in left or right canonical form, or we can use a mixed canonical form, as shown in <a class="reference internal" href="#fig-mixed"><span class="std std-numref">Fig. 4.3</span></a>. On the bond between the left and right canonical tensors, we have the Schmidt values (singular values of the Schmidt decomposition). It is common to keep these Schmidt values on the bond between the left and right canonical tensors, as this allows us to easily compute the entanglement entropy of the state. However, to simplify our code, we will instead introduce a central tensor, which we will call <span class="math notranslate nohighlight">\(C^{[n]}\)</span>. This tensor is equivalent to a left canonical tensor with the Schmidt values contracted from the right, and also to a right canonical tensor with the Schmidt values contracted from the left. We do this so that our state is still simply represented by a list of tensors all of the same rank. In order to do this, we need to keep track of the location of this central tensor. We add an attribute to our class called <code class="docutils literal notranslate"><span class="pre">centre</span></code>, which is the index of the central tensor. If the central tensor is at index <span class="math notranslate nohighlight">\(n\)</span>, then the left canonical tensors are at indices <span class="math notranslate nohighlight">\(1\)</span> to <span class="math notranslate nohighlight">\(n-1\)</span>, the central tensor is at index <span class="math notranslate nohighlight">\(n\)</span>, and the right canonical tensors are at indices <span class="math notranslate nohighlight">\(n+1\)</span> to <span class="math notranslate nohighlight">\(N\)</span>. We will later add a method to our class that moves the central tensor to a specified index.</p>
<figure class="align-center" id="fig-mixed">
<a class="reference internal image-reference" href="../../_images/mixed.jpeg"><img alt="../../_images/mixed.jpeg" src="../../_images/mixed.jpeg" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.3 </span><span class="caption-text">Representing an MPS in mixed canonical form. We choose to incorporate the Schmidt values into a central tensor, which we will call <span class="math notranslate nohighlight">\(C^{[n]}\)</span>. This tensor is equivalent to a left canonical tensor with the Schmidt values contracted from the right, and also to a right canonical tensor with the Schmidt values contracted from the left. We will keep track of the location of this central tensor with an attribute <code class="docutils literal notranslate"><span class="pre">centre</span></code> in our MPS class.</span><a class="headerlink" href="#fig-mixed" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Our code that converted a state vector into an MPS resulted in tensors in the left canonical form. This is because we started from the left and successively performed SVD, leaving behind left canonical tensors. Therefore, the centre of the MPS is at the last site of the chain.</p>
<p>The product state that we constructed is special. All of its tensors are simultaneously in left and right canonical form. This is because there is a single Schmidt value equal to 1 on each bond. We can therefore arbitrarily choose which site we call the centre.</p>
</div>
<div class="admonition-code-add-centre-to-mps-class admonition">
<p class="admonition-title">Code: Add centre to MPS class</p>
<p>In order to keep track of the centre site, we need to add an attribute to our MPS class. We will also need to update our previous methods, since the class initialization will now have an extra argument. We therefore have to make the following changes.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">class</span> <span class="nc">MPS</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">tensors</span><span class="p">,</span> <span class="n">centre</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">L</span>  <span class="c1"># number of sites</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tensors</span> <span class="o">=</span> <span class="n">tensors</span>  <span class="c1"># list of tensors. Indices are (left, physical, right)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">centre</span> <span class="o">=</span> <span class="n">centre</span>  <span class="c1"># position of the orthogonality centre</span>
        
    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">MPS</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">,</span> <span class="p">[</span><span class="n">tensor</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">tensor</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tensors</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">centre</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">fromVector</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">vector</span><span class="p">):</span>
        <span class="c1">## YOUR CODE HERE</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">tensors</span><span class="p">,</span> <span class="n">L</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">productState</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
        <span class="c1">## YOUR CODE HERE</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">tensors</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

</pre></div>
</div>
<p>This will be the final set of attributes for the MPS class.</p>
</div>
<section id="computing-expectation-values">
<h2><span class="section-number">4.1. </span>Computing expectation values<a class="headerlink" href="#computing-expectation-values" title="Link to this heading">#</a></h2>
<p>So, how does canonical form help us? Let us consider the computation of a local expectation value, e.g., <span class="math notranslate nohighlight">\(\langle \psi | \sigma^z_n | \psi \rangle\)</span>. Expectation value can be written as the tensor network diagram shown in <a class="reference internal" href="#fig-expectation"><span class="std std-numref">Fig. 4.4</span></a>. If we did not use canonical form, then we would need to perform the contraction site-by-site all the way along the length of the chain. However, if we use a mixed canonical form where the centre is on the site of the operator, the contraction to the left trivially gives us identity, and the same to the right. Therefore, we are left to contract only three tensors on the site of the operator, dramatically reducing the computation cost.</p>
<figure class="align-center" id="fig-expectation">
<a class="reference internal image-reference" href="../../_images/expectation.jpeg"><img alt="../../_images/expectation.jpeg" src="../../_images/expectation.jpeg" style="width: 90%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.4 </span><span class="caption-text">The computation of the expectation value for a single site operator. Using canonical form, the contraction of the two copies of the MPS reduces to a simple tensor contraction on the site of the operator.</span><a class="headerlink" href="#fig-expectation" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="moving-the-centre">
<h2><span class="section-number">4.2. </span>Moving the centre<a class="headerlink" href="#moving-the-centre" title="Link to this heading">#</a></h2>
<p>Since the computation of expectation values is most efficient when the operator acts on the same site as the position of the central tensor, we need to be able to move the centre to a desired site. This will also be necessary when computing the entanglement entropy. To do this we will use singular value decomposition to separate the Schmidt values from the central tensor, allowing us to contract them to the left or right. For example, in <a class="reference internal" href="#fig-move-centre"><span class="std std-numref">Fig. 4.5</span></a>, we show the process of moving the centre to the right. We start by contracting the central tensor with the tensor to its right (which should be in right canonical form). We then perform an SVD on the resulting tensor. By contracting the Schmidt values with the right tensor, we end up with a left canonical form tensor followed by the central tensor, and hence have moved the centre by one site to the right. An analogous process can be used to move the centre to the left.</p>
<figure class="align-center" id="fig-move-centre">
<a class="reference internal image-reference" href="../../_images/move_centre.jpeg"><img alt="../../_images/move_centre.jpeg" src="../../_images/move_centre.jpeg" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4.5 </span><span class="caption-text">The computation of the expectation value for a single site operator. Using canonical form, the contraction of the two copies of the MPS reduces to a simple tensor contraction on the site of the operator.</span><a class="headerlink" href="#fig-move-centre" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Note that when we contract the tensors to move the centre, we will want to keep track of the bond dimension <span class="math notranslate nohighlight">\(\chi\)</span> of the leg that we contract. This is because the SVD may result in tensors with larger bond dimension. However, we know that only the first <span class="math notranslate nohighlight">\(\chi\)</span> Schmidt values will be non-zero, so we should truncate the Schmidt values and the tensors to keep the bond dimension fixed. This truncation does not incur any approximation. Without doing this, our bond dimension would grow out of control. We will cover truncation for approximation purposes in the next section.</p>
<div class="admonition-code-move-centre-and-compute-expectation-value admonition">
<p class="admonition-title">Code: Move centre and compute expectation value</p>
<p>We can now add new methods to our MPS class that move the centre to the left or right, or to any site we choose. We can also add a method that computes the expectation value of a local operator acting on a site.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">class</span> <span class="nc">MPS</span><span class="p">:</span>

    <span class="c1">## Previous code omitted</span>

    <span class="k">def</span> <span class="nf">move_centre_left</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">## YOUR CODE HERE</span>
        <span class="c1">## Remember to truncate the bond dimension to match the original bond dimension</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">centre</span> <span class="o">-=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">move_centre_right</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">## YOUR CODE HERE</span>
        <span class="c1">## Remember to truncate the bond dimension to match the original bond dimension</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">centre</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">move_centre_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Move the orthogonality centre to site i.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">centre</span> <span class="o">&gt;</span> <span class="n">i</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move_centre_left</span><span class="p">()</span>

        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">centre</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">move_centre_right</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">expectation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">O</span><span class="p">,</span> <span class="n">site</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the expectation value of an operator at a given site.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        O : np.ndarray (shape=(2,2))</span>
<span class="sd">            Operator acting on a single site.</span>
<span class="sd">        site : int</span>
<span class="sd">            Site at which to compute the expectation value.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">move_centre_to</span><span class="p">(</span><span class="n">site</span><span class="p">)</span>

        <span class="c1">## YOUR CODE HERE</span>

        <span class="k">return</span> <span class="n">expectation</span> 

</pre></div>
</div>
<p>When you move the centre you want to catch the case where the centre is already at the end of the chain. Otherwise the while loop will continue indefinitely. You may also replace the while loops for safety.</p>
<p>Remember to truncate the bond dimension of the tensor after the SVD to match the original bond dimension. This increase in bond dimension does not contain additional information, and so we can safely truncate it without approximation.</p>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content/week2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../week1/mps.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3. </span>Matrix Product States</p>
      </div>
    </a>
    <a class="right-next"
       href="entanglement.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">5. </span>Entanglement and Truncation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-expectation-values">4.1. Computing expectation values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#moving-the-centre">4.2. Moving the centre</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Adam Gammon-Smith
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>